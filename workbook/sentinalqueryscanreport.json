{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## Sentinel Insights Query report \n---\n\nThis page is used to show scheduled hunting query report"
      },
      "name": "text - 2"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "sentinelscanreport_CL \r\n | where TimeGenerated > ago(1d)\r\n | where Category contains \"Sentinel-Insight-Detection\"\r\n | summarize arg_max(TimeGenerated, count_d) by rulename_s, Category, severity_s\r\n | where count_d > 0\r\n | extend severity_order = iff(severity_s == 'High',0, iff(severity_s == 'Medium',1,2))\r\n | summarize count = sum(count_d) by severity_s\r\n | render piechart ",
        "size": 0,
        "title": "Detection Rule by Severity",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "Detection Rule by Severity"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "sentinelscanreport_CL \r\n | where TimeGenerated > ago(1d)\r\n | where Category contains \"Sentinel-Insight-Detection\"\r\n | summarize arg_max(TimeGenerated, count_d) by rulename_s, Category, severity_s\r\n | where count_d > 0\r\n | extend severity_order = iff(severity_s == 'High',0, iff(severity_s == 'Medium',1,2))\r\n | order by severity_order asc, count_d desc\r\n | project rulename_s,Category, count_d,  severity_s\r\n | limit 20\r\n",
        "size": 0,
        "showAnalytics": true,
        "title": "top 20 Sentinel Detection Reports",
        "noDataMessage": "there is no active detection rule triggered",
        "timeContext": {
          "durationMs": 86400000
        },
        "showExportToExcel": true,
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "top 20 Sentinel Detection Reports"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "sentinelscanreport_CL \n | where TimeGenerated > ago(1d)\n | where Category contains \"Sentinel-Insight-Hunting\"\n | summarize count() by Category\n | render piechart ",
        "size": 1,
        "title": "hunting query report by category",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "hunting query report by category"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "sentinelscanreport_CL \r\n | where TimeGenerated > ago(1d)\r\n | where Category contains \"Sentinel-Insight-Hunting\"\r\n | summarize arg_max(TimeGenerated, count_d) by rulename_s, Category\r\n | project rulename_s,Category, count_d\r\n | order by count_d desc\r\n | limit 10\r\n",
        "size": 0,
        "showAnalytics": true,
        "title": "top 10 hunting rules which has data returned",
        "timeContext": {
          "durationMs": 86400000
        },
        "showExportToExcel": true,
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "top 10 hunting rules which has data returned"
    }
  ],
  "fallbackResourceIds": [
    "/subscriptions/0f2daa80-6b16-44ee-8016-4ad888e059ac/resourceGroups/omsdemo/providers/Microsoft.OperationalInsights/workspaces/somscndemo"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}